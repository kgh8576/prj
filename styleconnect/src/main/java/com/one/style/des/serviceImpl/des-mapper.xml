<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.one.style.des.mapper.DesMapper">
	<!-- 아이디 비밀번호체크 -->
	<!-- 로그인 -->
	<select id="designerlogin" parameterType="com.one.style.des.vo.DesVO" resultType="com.one.style.des.vo.DesVO">
		SELECT * FROM DESIGNER WHERE ID = #{id}
	</select>
	<!-- 회원가입 아이디 중복체크 -->
	<select id="designerinsertcheck" parameterType="com.one.style.des.vo.DesVO" resultType="com.one.style.des.vo.DesVO">
		SELECT * FROM DESIGNER WHERE ID = #{id}
	</select>
	<insert id="designerInsert"><!-- #{cergroupno} -->
		INSERT INTO DESIGNER VALUES
		(#{id},#{pw},#{name},#{hp},#{location},#{gender},to_date(#{birth},'YY/MM/DD'),0,'dcode001',#{career},sysdate,#{majorgender},#{makeupyn},#{cutyn},#{permyn},#{dyeyn},#{major},null)
	</insert>
	<!-- 비밀번호 변경 -->
	<update id="pwchange"
		parameterType="com.one.style.des.vo.DesVO">
		UPDATE DESIGNER SET PW = #{pw} WHERE ID = #{id}
	</update>
	
	<!-- 디자이너 선택 -->
	<select id="selectDes" parameterType="com.one.style.des.vo.DesVO" resultType="com.one.style.des.vo.DesVO">
		SELECT ID,PW,NAME,HP,LOCATION,GENDER, TO_CHAR(BIRTH, 'YYYY-MM-DD')AS BIRTH, CAREER, REGDAY, MAJOR_GENDER,MAKEUP_YN,CUT_YN,PERM_YN,DYE_YN,MAJOR
		FROM DESIGNER
		WHERE ID = #{id}
	</select>
	<!-- 디자이너 선택 - 프로필사진파일 -->
	<select id="selectDesPro" parameterType="com.one.style.des.vo.DesVO" resultType="com.one.style.des.vo.DesVO">
		SELECT   F.FILE_UUID
		FROM FILES F
		WHERE  F.FILE_STATE= 'pro'
		 	AND des_ID= #{id}
	</select>
	<!-- 디자이너 선택 - 증명서파일 -->
	<select id="selectDesCer" parameterType="com.one.style.des.vo.DesVO" resultType="com.one.style.des.vo.DesVO">
		SELECT   F.FILE_UUID, F.FILE_NAME
		FROM FILES F
		WHERE  F.FILE_STATE= 'cer'
		 	AND des_ID= #{id}
	</select>
	<!-- 기존비밀번호 확인 -->
	<select id="pwCheck" parameterType="com.one.style.des.vo.DesVO" resultType="com.one.style.des.vo.DesVO">
	SELECT PW 
	FROM DESIGNER 
	WHERE ID = #{id} 
	</select>

	<!-- 디자이너 수정 -->
	<update id="desUpdate" parameterType="com.one.style.des.vo.DesVO">
	update designer 
	set hp= #{hp}, location= #{location}, pw= #{pw}, major= #{major},
	 	major_gender=#{majorgender},career=#{career},makeup_yn=#{makeupyn},perm_yn=#{permyn},cut_yn=#{cutyn},dye_yn=#{dyeyn}
	where id= #{id}
	</update>
	
	<!-- 디자이너 파일수정 -->
	<update id="desFileUpdate" parameterType="com.one.style.des.vo.DesVO">
	update files
	set file_state = 'del'
	where file_uuid= #{fileUuid}
	</update>

	<!-- 디자이너 major 수정 -->
	<update id="desmajorUpdate" parameterType="com.one.style.des.vo.DesVO">
	update designer 
	set major= #{major}
	where id= #{id,jdbcType=VARCHAR}
	</update>
	
</mapper>