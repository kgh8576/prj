<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper	namespace="com.one.style.conhistory.mapper.ConhistoryMapper">

	<select id="conHistoryList" parameterType="com.one.style.conhistory.vo.ConHistoryVO" resultType="com.one.style.conhistory.vo.ConHistoryVO">
		select con_no, day, time, designer.id as des_id, name as des_name, title, detail, des_comment, codecontent as state
  			from consulting_history, des_course, designer, commcodedetail
  			where consulting_history.cour_no = des_course.cour_no
    			and des_course.id = designer.id
    			and consulting_history.state = commcodedetail.code
    		<!-- 테스트 코드 !!!!추후수정!!!!!-->
    			and des_course.id='des05'
    		<!-- 원본 코드: and consulting_history.mem_id=#{memId} -->
  			order by con_no desc
  			<!-- 디자이너인 경우 디자이너 아이디로 검색하게 함 -->
	</select>
	
	<select id="desCourseDetail" parameterType="com.one.style.conhistory.vo.ConHistoryVO" resultType="com.one.style.des.vo.DesVO">
		select cour_no, d.id , d.name , d.career , major , dc.title , dc.detail, price
		from designer d
		join des_course dc
		on d.id = dc.id
		where cour_no = #{courNo}
	</select>
	
	<insert id="conHistoryInsert" parameterType="com.one.style.conhistory.vo.ConHistoryVO">
		insert into CONSULTING_HISTORY
		values
		(seq_con() , #{day} ,#{time},'ccode001',#{price},sysdate , #{memId} , #{memComment} ,#{courNo} ,null,#{payNo}, 'N' ,'N')
	</insert>
	
	<select id="seqTest" resultType="_int">
		select test_seq.nextval from dual 
	</select>
	
	
</mapper>